参考:[エクセル シート名を取得する](https://www.tipsfound.com/excel/01306)<br/>

1. 各シートごとにシート名をA1に表示(1シート目は目次のため例外)
2. 1シート目に目次として各シート名を表示

例
1. シートを4つ作成
2. シート1-4のA1に以下の式 -> 各シートのA1にシート名を表示
<pre>
=RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1)))
</pre>
3. シート1でシート名一覧取得
<pre>
1 任意のセルで 数式タブ→名前の定義
  - 名前:book
  - 参照範囲:=GET.WORKBOOK(1)
2 任意のセルで 数式タブ→名前の定義
  - 名前:doc
  - 参照範囲:=GET.DOCUMENT(88)
    # GET.DOCUMENT()はファイルの情報を返す関数
    # 88 は「アクティブブックの名前を文字列で返す」
    # http://excel4macro.blog86.fc2.com/blog-entry-170.html
</pre>
4. シート1で目次として各シート名表示
<pre>
各シート名を表示したいセルに以下の式
=SUBSTITUTE(INDEX(book,x),"["&doc&"]","")
  # xは表示したいシートインデックス
  # もしくはxの場所にROW()±x とする
=SUBSTITUTE(INDEX(book,ROW()-1),"["&doc&"]","")
</pre>

5. 目次シートで各シート名のハイパーリンク
### [HYPERLINK関数で、同じブック内のシートにハイパーリンク](https://www.relief.jp/docs/000998.html) 
### [HYPERLINK関数の使い方](http://www.eurus.dti.ne.jp/~yoneyama/Excel/kansu/hyperlink.htm)

```
=HYPERLINK(リンク先,別名)

=HYPERLINK("#" & SUBSTITUTE(INDEX(book,4),"["&doc&"]","") & "!A1", SUBSTITUTE(INDEX(book,4),"["&doc&"]",""))
 # シートxのA1にリンク 表示はシート名
```


## office2021からデフォルトでは使用できなくなった
[『EXCEL2021で前シートの参照がエラーになる』](https://www.excel.studio-kazu.jp/kw/20220704104310.html)
```
定義=MID(INDEX(GET.WORKBOOK(1)&T(NOW()),GET.DOCUMENT(87)-1),FIND("]",INDEX(GET.WORKBOOK(1)&T(NOW()),GET.DOCUMENT(87)-1))+1,31)
で左隣のシートを参照しています。
先日会社のPC入れ替えでEXCEL2021になった時からエラーで表示されなくなってしまいました。

無知ななかいろいろ調べて設定した定義なのでなおし方がわかりません。
よろしくお願いします。
＜ 使用 アプリ：EXCEL2021、使用 OS：Windows10 ＞
```
```
その定義で使われているのはExcel4.0マクロ言語というもので今のVBA以前にマクロとして使われていたもの。
 マイクロソフトはEXCELの新しいバージョンでは規定で無効にするようにした。
 一応下記の方法で有効にはできるがマイクロソフトではVBAに置き換えるように勧めている。
https://support.microsoft.com/ja-jp/office/excel-4-0-%E3%83%9E%E3%82%AF%E3%83%AD%E3%82%92%E6%93%8D%E4%BD%9C%E3%81%99%E3%82%8B-ba8924d4-e157-4bb2-8d76-2c07ff02e0b8#:~:text=%5B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%5D%20%E3%82%BF%E3%83%96%E3%82%92%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%97,%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E3%82%92%E3%82%AA%E3%83%B3%E3%81%AB%E3%81%97%E3%81%BE%E3%81%99%E3%80%82
```

### XLM マクロを実行できるようにマクロの設定を変更するには、次の操作を行います。
1. [ファイル] タブをクリックし、[オプション] をクリックします。
2. [セキュリティ センター] をクリックし、[セキュリティ センターの設定] をクリックします。
3. [マクロ設定] をクリックし、[VBA マクロが有効になっているときに Excel 4.0 マクロを有効にする] ボックスチェック選択します。 その後、[通知を使用して VBA マクロを無効にする] または [すべてのマクロを有効にする ] を選択できます (推奨されません。危険なコードが実行される可能性があります)。 <br>
重要:  [すべてのマクロを有効にする] (推奨されていない、危険な可能性のあるコードを実行する) 設定を使用しないことをお勧めします。また、実行した場合は、マクロ セキュリティ設定を [通知で VBA マクロを無効にする] または [通知なしで VBA マクロを無効にする] にできるだけ早く戻することをお勧めします。
4. [ファイル ブロック設定] をクリックし、[ファイルの種類] で [Excel 4 マクロシート] を選択し、[開く] の [チェック] ボックスが選択されていることを確認します。
5. [選択した形式のファイルを開く処理] で [選択した形式のファイルを保護ビューで開き、編集可能にする] をクリックします。
6. [OK] を 2 回クリックします。
<br>
[セキュリティ センター]→[トラストセンター]<br>
[セキュリティ センターの設定] →[トラストセンターの設定]<br>
